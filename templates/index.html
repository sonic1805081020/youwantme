{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Mes M√©dias</h1>
    <a href="{{ url_for('upload_video') }}" class="btn btn-primary">
        ‚ûï Ajouter un m√©dia
    </a>
</div>

{% if videos %}
    <div class="row">
        {% for media in videos %}
        <div class="col-md-4 mb-4">
            <div class="card video-card h-100">
                <div class="position-relative">
                    {% if media[11] == 'photo' %}
                        <!-- Photo -->
                        <img src="{{ url_for('serve_video', filename=media[1] if media[1] else media[2]) }}" 
                             class="card-img-top" style="height: 200px; object-fit: cover;" 
                             alt="{{ media[3] }}">
                        <div class="video-duration bg-info">
                            üì∏ Photo
                        </div>
                    {% else %}
                        <!-- Vid√©o -->
                        <div class="video-placeholder" style="height: 200px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white;">
                            <div class="text-center">
                                <i style="font-size: 3rem;">üé¨</i>
                                <h6 class="mt-2 mb-0">{{ media[3] }}</h6>
                                <small>Cliquer pour regarder</small>
                            </div>
                        </div>
                        <div class="video-duration">
                            {% if media[5] and media[5] > 0 %}
                                {{ "%.0f"|format(media[5] // 60) }}:{{ "%02.0f"|format(media[5] % 60) }}
                            {% else %}
                                --:--
                            {% endif %}
                        </div>
                    {% endif %}
                    
                    <!-- Badge de stockage -->
                    <div class="position-absolute top-0 start-0 m-2">
                        {% if media[8] == 'cloudinary' %}
                            <span class="badge bg-success">‚òÅÔ∏è Cloud</span>
                        {% else %}
                            <span class="badge bg-secondary">üíæ Local</span>
                        {% endif %}
                    </div>
                </div>
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">{{ media[3] }}</h5>
                    <p class="card-text flex-grow-1">
                        {{ media[4][:100] if media[4] else '' }}{% if media[4] and media[4]|length > 100 %}...{% endif %}
                    </p>
                    <small class="text-muted mb-2">
                        {% if media[11] == 'photo' %}
                            üì∏ Photo ‚Ä¢ 
                        {% else %}
                            üé¨ Vid√©o ‚Ä¢ 
                        {% endif %}
                        {% if media[12] %}{{ "%.1f"|format(media[12] / 1024 / 1024) }} MB ‚Ä¢ {% endif %}
                        {{ media[6] }}
                    </small>
                    <div class="mt-auto">
                        <a href="{{ url_for('watch_video', video_id=media[0]) }}" 
                           class="btn btn-primary btn-sm">
                           {% if media[11] == 'photo' %}üëÄ Voir{% else %}‚ñ∂Ô∏è Regarder{% endif %}
                        </a>
                        <a href="{{ url_for('download_video', video_id=media[0]) }}" 
                           class="btn btn-success btn-sm">‚¨áÔ∏è T√©l√©charger</a>
                        <a href="{{ url_for('delete_video', video_id=media[0]) }}" 
                           class="btn btn-danger btn-sm"
                           onclick="return confirm('√ätes-vous s√ªr de vouloir supprimer ce m√©dia ?')">
                           üóëÔ∏è Supprimer</a>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
{% else %}
    <div class="text-center py-5">
        <h3 class="text-muted">Aucun m√©dia pour le moment</h3>
        <p class="text-muted">Commencez par ajouter votre premier m√©dia !</p>
        <a href="{{ url_for('upload_video') }}" class="btn btn-primary">
            ‚ûï Ajouter un m√©dia
        </a>
    </div>
{% endif %}
{% endblock %}